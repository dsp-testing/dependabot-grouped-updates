version: 2
multi-ecosystem-groups:
  vite:
    schedule:
      interval: "weekly"

updates:
  - package-ecosystem: "bundler" # See documentation for possible values
    directory: "/" # Location of package manifests
    patterns:
      - "vite*"
    multi-ecosystem-group: "vite"
  - package-ecosystem: "npm" # See documentation for possible values
    directory: "/" # Location of package manifests
    patterns:
      - "vite*"
    multi-ecosystem-group: "vite"
  - package-ecosystem: "bundler" # See documentation for possible values
    directory: "/" # Location of package manifests
    schedule:
      interval: "weekly"
    groups:
      aws:
        patterns:
          - "aws*"
  - package-ecosystem: "npm" # See documentation for possible values
    directory: "/" # Location of package manifests
    schedule:
      interval: "weekly"

  # Bundler monorepo grouped updates testing (gems/app-a)
  - package-ecosystem: "bundler"
    directory: "/gems/app-a"
    schedule:
      interval: "monthly"
    groups:
      grouped-bundler-deps:
        patterns:
          - "aws*"
          - "rails"
        update-types: ["minor", "patch"]

  # Bundler monorepo grouped updates testing (gems/app-b)
  - package-ecosystem: "bundler"
    directory: "/gems/app-b"
    schedule:
      interval: "monthly"
    groups:
      grouped-bundler-deps:
        patterns:
          - "aws*"
          - "rails"
        update-types: ["minor", "patch"]

  # === group-by: dependency-name testing ===

  # Test 1: group-by as sole rule (bundler, single directory)
  - package-ecosystem: "bundler"
    directory: "/group-by/bundler-standalone"
    schedule:
      interval: "weekly"
    groups:
      per-dependency:
        group-by: dependency-name

  # Test 2: group-by combined with patterns (bundler, single directory)
  - package-ecosystem: "bundler"
    directory: "/group-by/bundler-with-patterns"
    schedule:
      interval: "weekly"
    groups:
      filtered-per-dependency:
        patterns:
          - "aws*"
          - "rails"
        group-by: dependency-name

  # Test 3: group-by with multi-directory (bundler)
  - package-ecosystem: "bundler"
    directories:
      - "/group-by/bundler-multi-dir/app-a"
      - "/group-by/bundler-multi-dir/app-b"
    schedule:
      interval: "weekly"
    groups:
      per-dependency:
        group-by: dependency-name

  # Test 4: group-by as sole rule (npm, single directory)
  - package-ecosystem: "npm"
    directory: "/group-by/npm-standalone"
    schedule:
      interval: "weekly"
    groups:
      per-dependency:
        group-by: dependency-name
